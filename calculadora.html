<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Calculadora de Costos 3D | ODA Studio</title>

  <style>
    :root{
      --bg: #05060a;
      --card: rgba(255,255,255,.06);
      --text: #ffffff;
      --muted: rgba(255,255,255,.70);
      --line: rgba(255,255,255,.14);
      --accent: #00d9ff;
      --accent2: #ff3e7a;
      --ok: #45ff8f;
      --warn: #ffd166;
      --shadow: 0 16px 50px rgba(0,0,0,.55);
      --radius: 18px;
    }

    *{box-sizing:border-box;}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:
        radial-gradient(900px 450px at 10% 10%, rgba(0,217,255,.18), transparent 55%),
        radial-gradient(800px 450px at 90% 10%, rgba(255,62,122,.12), transparent 55%),
        radial-gradient(1000px 600px at 50% 110%, rgba(157,78,221,.12), transparent 60%),
        var(--bg);
      color: var(--text);
      min-height: 100vh;
      padding: 22px 14px;
    }

    .wrap{
      max-width: 1100px;
      margin: 0 auto;
    }

    header{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 16px;
      margin-bottom: 16px;
    }

    .title{
      display:flex;
      flex-direction:column;
      gap: 6px;
    }

    h1{
      margin:0;
      font-size: clamp(1.25rem, 3vw, 1.85rem);
      letter-spacing: .3px;
      line-height: 1.2;
    }

    .subtitle{
      color: var(--muted);
      font-size: .95rem;
      max-width: 62ch;
      line-height: 1.35;
    }

    .badge{
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.06);
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
      font-size: .9rem;
      color: var(--muted);
      white-space: nowrap;
    }

    .grid{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap: 14px;
    }

    @media (max-width: 900px){
      .grid{ grid-template-columns: 1fr; }
    }

    .card{
      background: linear-gradient(180deg, var(--card), rgba(255,255,255,.03));
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .cardHead{
      padding: 14px 14px 10px;
      border-bottom: 1px solid var(--line);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
    }

    .cardHead h2{
      margin:0;
      font-size: 1rem;
      letter-spacing:.2px;
    }

    .hint{
      color: var(--muted);
      font-size:.85rem;
    }

    .cardBody{
      padding: 14px;
    }

    .section{
      background: rgba(255,255,255,.04);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 14px;
      padding: 12px;
      margin-bottom: 12px;
    }
    .section:last-child{ margin-bottom:0; }

    .sectionTitle{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      margin-bottom: 10px;
    }

    .sectionTitle strong{ font-size: .95rem; }
    .mini{
      font-size:.82rem;
      color: var(--muted);
    }

    .row{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }

    @media (max-width: 520px){
      .row{ grid-template-columns: 1fr; }
      header{flex-direction:column;}
      .badge{ width: fit-content; }
    }

    label{
      display:flex;
      flex-direction:column;
      gap: 6px;
      font-size:.86rem;
      color: var(--muted);
    }

    input{
      width:100%;
      padding: 11px 12px;
      border-radius: 12px;
      outline:none;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.35);
      color: var(--text);
      font-size: 1rem;
      transition: .2s ease;
    }

    input:focus{
      border-color: rgba(0,217,255,.55);
      box-shadow: 0 0 0 4px rgba(0,217,255,.12);
    }

    .actions{
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 12px;
    }

    button{
      border: 0;
      cursor:pointer;
      padding: 12px 14px;
      border-radius: 14px;
      font-weight: 700;
      letter-spacing:.2px;
      transition: transform .08s ease, opacity .2s ease;
      display:flex;
      align-items:center;
      gap: 8px;
    }
    button:active{ transform: scale(.98); }

    .btnPrimary{
      background: linear-gradient(90deg, rgba(0,217,255,.92), rgba(255,62,122,.92));
      color: #07080c;
    }

    .btnGhost{
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.14);
      color: var(--text);
    }

    .note{
      margin-top: 10px;
      color: var(--muted);
      font-size: .85rem;
      line-height: 1.45;
    }

    .results{
      display:flex;
      flex-direction:column;
      gap: 12px;
    }

    .totalBox{
      padding: 14px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.16);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
    }

    .totalTop{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap: 10px;
      margin-bottom: 10px;
    }

    .big{
      font-size: 1.8rem;
      font-weight: 900;
      letter-spacing:.3px;
    }

    .pill{
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.25);
      color: var(--muted);
      font-size: .82rem;
      white-space: nowrap;
    }

    .breakdown{
      border-top: 1px solid rgba(255,255,255,.12);
      padding-top: 10px;
      display:grid;
      gap: 8px;
    }

    .line{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: 10px;
      color: var(--muted);
      font-size: .95rem;
    }

    .line b{
      color: var(--text);
      font-weight: 800;
    }

    .good{ color: var(--ok); font-weight: 900; }
    .warn{ color: var(--warn); font-weight: 900; }

    .smallHelp{
      font-size: .82rem;
      color: var(--muted);
      margin-top: 10px;
      line-height: 1.45;
    }

    .tiny{
      opacity:.85;
      font-size:.82rem;
      line-height: 1.45;
    }

    .err{
      margin-top: 10px;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,62,122,.35);
      background: rgba(255,62,122,.12);
      color: #ffd9e6;
      display:none;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="title">
        <h1>Calculadora de Costos de ImpresiÃ³n 3D</h1>
        <div class="subtitle">
          Material (regla de 3) + Luz + Desgaste + Tu tiempo + (Dificultad/Riesgo 20%).<br>
          <span class="tiny">Incluye <b>Precio al cliente</b> + <b>Costo real</b> + <b>Ganancia</b>.</span>
        </div>
      </div>
      <div class="badge">ODA STUDIO â€¢ Tool</div>
    </header>

    <div class="grid">
      <!-- INPUTS -->
      <section class="card">
        <div class="cardHead">
          <h2>Datos de la impresiÃ³n</h2>
          <div class="hint">Llena y se calcula solo</div>
        </div>

        <div class="cardBody">
          <div class="section">
            <div class="sectionTitle">
              <strong>1) Material (Filamento)</strong>
              <span class="mini">Regla de 3 + x2</span>
            </div>

            <div class="row">
              <label>
                Precio del filamento (por kilo)
                <input id="filamentPriceKg" type="number" min="0" step="0.01" placeholder="Ej. 450" />
              </label>
              <label>
                Peso de la pieza (gramos)
                <input id="pieceWeightG" type="number" min="0" step="0.1" placeholder="Ej. 120" />
              </label>
            </div>

            <div class="row" style="margin-top:10px;">
              <label>
                Peso del filamento (normalmente 1000g)
                <input id="kgWeightG" type="number" min="1" step="1" value="1000" />
              </label>
              <label>
                Nota
                <input type="text" value="Precio cliente = material x2 âœ…" disabled />
              </label>
            </div>
          </div>

          <div class="section">
            <div class="sectionTitle">
              <strong>2) Luz</strong>
              <span class="mini">$4 por hora</span>
            </div>

            <div class="row">
              <label>
                Horas de impresiÃ³n
                <input id="lightHours" type="number" min="0" step="1" placeholder="Ej. 6" />
              </label>
              <label>
                Minutos
                <input id="lightMinutes" type="number" min="0" step="1" placeholder="Ej. 30" />
              </label>
            </div>
          </div>

          <div class="section">
            <div class="sectionTitle">
              <strong>3) Tu tiempo</strong>
              <span class="mini">$50 1ra hora + $10 extra</span>
            </div>

            <div class="row">
              <label>
                Horas trabajadas
                <input id="laborHours" type="number" min="0" step="1" placeholder="Ej. 2" />
              </label>
              <label>
                Minutos trabajados
                <input id="laborMinutes" type="number" min="0" step="1" placeholder="Ej. 15" />
              </label>
            </div>

            <div class="smallHelp">
              Primera hora se cobra completa en <b>$50</b>.  
              Si pasas de 1h, lo extra se cobra proporcional a <b>$10/h</b>.
            </div>
          </div>

          <div class="actions">
            <button class="btnPrimary" id="btnCalc">âš¡ Calcular</button>
            <button class="btnGhost" id="btnReset">ðŸ§¼ Reiniciar</button>
          </div>

          <div class="note">
            âœ… FÃ³rmulas:
            <div class="tiny">
              Material costo real = (peso Ã— precioKilo) Ã· 1000<br>
              Material cliente = material Ã— 2<br>
              Luz = 4 Ã— (horas + minutos/60)<br>
              Desgaste = (Material costo real + Luz) Ã— 0.15<br>
              Tu tiempo = 50 + (horasExtra Ã— 10)<br>
              Riesgo = (Material cliente + Luz + Desgaste + Tiempo) Ã— 0.20<br>
              Total cliente = Subtotal + Riesgo
            </div>
          </div>

          <div class="err" id="errorBox"></div>
        </div>
      </section>

      <!-- RESULTS -->
      <aside class="card">
        <div class="cardHead">
          <h2>Resultados</h2>
          <div class="hint">Desglose + ganancia</div>
        </div>

        <div class="cardBody results">
          <div class="totalBox">
            <div class="totalTop">
              <div>
                <div class="pill">Precio al cliente (Total)</div>
                <div style="margin-top:6px;" class="big" id="finalTotal">$0.00</div>
              </div>
              <div class="pill">MXN</div>
            </div>

            <div class="breakdown">
              <div class="line">
                <span>Material (costo real)</span>
                <b id="materialBase">$0.00</b>
              </div>

              <div class="line">
                <span>Material (precio cliente x2)</span>
                <b id="materialX2">$0.00</b>
              </div>

              <div class="line">
                <span>Luz</span>
                <b id="lightCost">$0.00</b>
              </div>

              <div class="line">
                <span>Desgaste (15%)</span>
                <b id="wearCost">$0.00</b>
              </div>

              <div class="line">
                <span>Tu tiempo</span>
                <b id="laborCost">$0.00</b>
              </div>

              <div class="line" style="border-top:1px solid rgba(255,255,255,.12); padding-top:10px;">
                <span>Subtotal (sin riesgo)</span>
                <b class="good" id="subtotal">$0.00</b>
              </div>

              <div class="line">
                <span>Dificultad/Riesgo (20%)</span>
                <b class="warn" id="riskCost">$0.00</b>
              </div>

              <div class="line" style="border-top:1px solid rgba(255,255,255,.12); padding-top:10px;">
                <span><b style="color:#fff;">TOTAL FINAL CLIENTE</b></span>
                <b style="font-size:1.05rem;" id="finalTotal2">$0.00</b>
              </div>

              <!-- NUEVO -->
              <div class="line" style="border-top:1px solid rgba(255,255,255,.12); padding-top:10px;">
                <span><b style="color:#fff;">COSTO REAL (tu costo)</b></span>
                <b id="realCost">$0.00</b>
              </div>

              <div class="line">
                <span><b style="color:#fff;">GANANCIA (para ti)</b></span>
                <b class="good" id="profit">$0.00</b>
              </div>
            </div>

            <div class="smallHelp">
              ðŸ’¡ <b>Costo real</b> = Material costo real + Luz<br>
              ðŸ’° <b>Ganancia</b> = Total cliente - Costo real
            </div>
          </div>
        </div>
      </aside>
    </div>
  </div>

  <script>
    // ===== Helpers =====
    const $ = (id) => document.getElementById(id);

    const money = (n) => {
      if (!isFinite(n)) return "$0.00";
      return n.toLocaleString("es-MX", { style: "currency", currency: "MXN" });
    };

    const num = (value) => {
      const n = parseFloat(value);
      return isNaN(n) ? 0 : n;
    };

    const clamp = (n, min, max) => Math.min(max, Math.max(min, n));

    // ===== Elements =====
    const filamentPriceKg = $("filamentPriceKg");
    const pieceWeightG    = $("pieceWeightG");
    const kgWeightG       = $("kgWeightG");

    const lightHours      = $("lightHours");
    const lightMinutes    = $("lightMinutes");

    const laborHours      = $("laborHours");
    const laborMinutes    = $("laborMinutes");

    const btnCalc         = $("btnCalc");
    const btnReset        = $("btnReset");
    const errorBox        = $("errorBox");

    // Outputs
    const outFinalTotal   = $("finalTotal");
    const outFinalTotal2  = $("finalTotal2");
    const outMaterialBase = $("materialBase");
    const outMaterialX2   = $("materialX2");
    const outLightCost    = $("lightCost");
    const outWearCost     = $("wearCost");
    const outLaborCost    = $("laborCost");
    const outSubtotal     = $("subtotal");
    const outRiskCost     = $("riskCost");

    // NEW
    const outRealCost     = $("realCost");
    const outProfit       = $("profit");

    function calc() {
      errorBox.style.display = "none";
      errorBox.textContent = "";

      // ===== INPUTS =====
      const priceKg = num(filamentPriceKg.value);
      const pieceG  = num(pieceWeightG.value);
      const kiloG   = Math.max(1, num(kgWeightG.value)); // 1000

      const hLight  = clamp(num(lightHours.value), 0, 9999);
      const mLight  = clamp(num(lightMinutes.value), 0, 9999);

      const hLabor  = clamp(num(laborHours.value), 0, 9999);
      const mLabor  = clamp(num(laborMinutes.value), 0, 9999);

      if (priceKg < 0 || pieceG < 0) {
        errorBox.textContent = "âš ï¸ No uses valores negativos.";
        errorBox.style.display = "block";
        return;
      }

      // ===== 1) MATERIAL =====
      // costo real (sin ganancia)
      const materialBase = (pieceG * priceKg) / kiloG;

      // precio al cliente = x2
      const materialX2 = materialBase * 2;

      // ===== 2) LUZ =====
      // $4 por hora
      const lightTotalHours = hLight + (mLight / 60);
      const lightCost = 4 * lightTotalHours;

      // ===== 3) DESGASTE =====
      // (materialBase + luz) * 0.15
      const wearCost = (materialBase + lightCost) * 0.15;

      // ===== 4) TU TIEMPO =====
      // 1ra hora: $50
      // extra: $10/h proporcional
      const laborTotalHours = hLabor + (mLabor / 60);
      let laborCost = 0;

      if (laborTotalHours <= 0) {
        laborCost = 0;
      } else if (laborTotalHours <= 1) {
        laborCost = 50;
      } else {
        laborCost = 50 + ((laborTotalHours - 1) * 10);
      }

      // ===== SUBTOTAL (sin riesgo) =====
      // OJO: AQUÃ ENTRA materialX2 (precio cliente)
      const subtotal = materialX2 + lightCost + wearCost + laborCost;

      // ===== RIESGO 20% =====
      const riskCost = subtotal * 0.20;

      // ===== TOTAL CLIENTE =====
      const totalFinal = subtotal + riskCost;

      // ===== COSTO REAL + GANANCIA =====
      // costo real verdadero = materialBase + luz
      const realCost = materialBase + lightCost;

      // ganancia total = total cliente - costo real
      const profit = totalFinal - realCost;

      // ===== UI UPDATES =====
      outMaterialBase.textContent = money(materialBase);
      outMaterialX2.textContent   = money(materialX2);
      outLightCost.textContent    = money(lightCost);
      outWearCost.textContent     = money(wearCost);
      outLaborCost.textContent    = money(laborCost);
      outSubtotal.textContent     = money(subtotal);
      outRiskCost.textContent     = money(riskCost);

      outFinalTotal.textContent   = money(totalFinal);
      outFinalTotal2.textContent  = money(totalFinal);

      outRealCost.textContent     = money(realCost);
      outProfit.textContent       = money(profit);
    }

    function resetAll() {
      filamentPriceKg.value = "";
      pieceWeightG.value = "";
      kgWeightG.value = "1000";

      lightHours.value = "";
      lightMinutes.value = "";

      laborHours.value = "";
      laborMinutes.value = "";

      outFinalTotal.textContent = "$0.00";
      outFinalTotal2.textContent = "$0.00";
      outMaterialBase.textContent = "$0.00";
      outMaterialX2.textContent = "$0.00";
      outLightCost.textContent = "$0.00";
      outWearCost.textContent = "$0.00";
      outLaborCost.textContent = "$0.00";
      outSubtotal.textContent = "$0.00";
      outRiskCost.textContent = "$0.00";

      outRealCost.textContent = "$0.00";
      outProfit.textContent = "$0.00";

      errorBox.style.display = "none";
      errorBox.textContent = "";
    }

    // EVENTS
    btnCalc.addEventListener("click", calc);
    btnReset.addEventListener("click", resetAll);

    [
      filamentPriceKg, pieceWeightG, kgWeightG,
      lightHours, lightMinutes,
      laborHours, laborMinutes
    ].forEach(el => el.addEventListener("input", calc));

    // Start
    calc();
  </script>
</body>
</html>
